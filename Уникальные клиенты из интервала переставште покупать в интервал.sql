SELECT DISTINCT(P_UID), TO_CHAR(MAX(ORDERS.CREATEDTS), 'DD.MM.YY')  FROM HYBRIS.ORDERS
JOIN HYBRIS.USERS ON USERS.PK = ORDERS.P_USER
WHERE ORDERS.CREATEDTS BETWEEN '01.04.17 00.00.00,000000000' AND '31.03.18 23.59.59,000000000' AND P_UID IS NOT NULL
GROUP BY P_UID
HAVING MAX(ORDERS.CREATEDTS) BETWEEN '01.04.17 00.00.00,000000000' AND '30.01.2018 23.59.59,000000000'
ORDER BY P_UID;